<link rel="import" href="../../iron-ajax/iron-ajax.html"> <link rel="import" href="coinify-shared.html"> <link rel="import" href="coinify-api-behaviour.html"> <dom-module id="coinify-api"> <template> <style include="coinify-shared"></style> <iron-ajax id="bankAccount" headers="{{ajaxHeaders}}" url="{{_computeBankUrl(coinifyApiBaseUrl, params)}}" last-response="{{lastResponse}}" on-response="_handleApiResponse" on-error="_handleApiError" handle-as="json"> </iron-ajax> <iron-ajax id="trades" headers="{{ajaxHeaders}}" url="{{coinifyApiBaseUrl}}/trades" last-response="{{lastResponse}}" on-response="_handleApiResponse" on-error="_handleApiError" handleas="json"> </iron-ajax> </template> <script>Polymer({is:"coinify-api",behaviors:[CoinifyApiBehaviour],properties:{generalError:{type:String,notify:!0},endpoint:String,params:Object,lastResponse:{type:Object,notify:!0,readOnly:!0}},generateRequest:function(){this.$[this.endpoint].generateRequest()},_computeBankUrl:function(e,n){return e+"/bank-accounts/"+n.bankAccountId},_handleApiResponse:function(e,n){this._setLastResponse(n.response),this.fire("response",n,{bubbles:!1})},_handleApiError:function(e,n){this._setLastResponse(null);var r=n.request.xhr.response||(n.request.xhr.status||"unknown")+" "+(n.request.xhr.statusText||"unknown");console.log('Error calling coinify-api endpoint "'+this.endpoint+'": '+r),this.generalError=r,this.fire("error",{request:n.request,error:n.error},{bubbles:!1})}})</script> </dom-module>
<link rel="import" href="coinify-shared.html"> <link rel="import" href="coinify-api-behaviour.html"> <link rel="import" href="coinify-trade-status-transfer.html"> <link rel="import" href="coinify-util-behaviour.html"> <dom-module id="coinify-trade-status"> <template> <style include="coinify-shared">span{white-space:nowrap}</style> <template is="dom-if" if="{{_isStringEqual(trade.inCurrency, &apos;BTC&apos;)}}" restamp="true"> <p>Your purchase of <strong>[[trade.transferOut.receiveAmount]] [[trade.outCurrency]]</strong> for <strong>[[_formatAsFiat(trade.transferIn.sendAmount)]] [[trade.inCurrency]]</strong> {{localize(&apos;sell_order_status_status&apos;, &apos;status&apos;, trade.state)}}.</p></template> <template is="dom-if" if="{{!_isStringEqual(trade.inCurrency, &apos;BTC&apos;)}}" restamp="true"> <p>Your purchase of <strong>[[trade.transferOut.receiveAmount]] [[trade.outCurrency]]</strong> for <strong>[[_formatAsFiat(trade.transferIn.sendAmount)]] [[trade.inCurrency]]</strong> {{localize(&apos;order_status_status&apos;, &apos;status&apos;, trade.state)}} via [[trade.transferIn.medium]].</p> </template> <div hidden$="[[!showCardChargeWarning]]" class="alert alert-warning"> <p>Your card has been charged and we are now performing a security check which will be completed within one business day. In case your order is rejected a refund will be issued. Refunds depend entirely on bank processing times and may take a few days to reach your bank account. Thank you for your patience!</p> </div> <div hidden$="[[!showCardRejectExplanation]]" class="alert alert-danger"> <p>Unfortunately, we cannot process trade order #[[trade.id]]. Due to security regulations, the reason cannot be disclosed. In case your card has been charged, an automatic refund has been issued for your order but please be aware that it may take a few more days for the funds to show in your bank account. If you still wish to buy Bitcoin, you can try making a trade using Bank transfer.</p> </div> <h4>Trade</h4> <div class="container-fluid"> <div class="row panel"> <div class="col-sm-6"> {{localize(&apos;order_status_trade_id_label&apos;)}} </div> <div class="col-sm-6 text-right"> #{{trade.id}} </div> </div> <div class="row panel" hidden$="[[!_isTradeCompleted(trade.state)]]"> <div class="col-sm-6"> Final rate <coinify-info width="200"> This is the current rate obtained at the moment the order is processed. Notice that there might be changes in rate until we receive your bank transfer and process your order. </coinify-info> </div> <div class="col-sm-6 text-right"> {{_getRate(trade.inAmount, trade.outAmount, trade.inCurrency, trade.outCurrency)}} </div> </div> <div class="row panel"> <div class="col-sm-6"> Expected rate <coinify-info width="200"> This is the current rate obtained at the moment of creating the order. </coinify-info> </div> <div class="col-sm-6 text-right"> {{_getRate(trade.inAmount, trade.outAmountExpected, trade.inCurrency, trade.outCurrency)}} </div> </div> <div class="row panel"> <div class="col-sm-6"> {{localize(&apos;order_status_date_created_label&apos;)}} </div> <div class="col-sm-6 text-right"> {{_formatAsDate(trade.createTime)}} </div> </div> </div> <h4>Payout</h4> <coinify-trade-status-transfer coinify-api-base-url="[[coinifyApiBaseUrl]]" access-token="[[accessToken]]" transfer="[[trade.transferOut]]"> </coinify-trade-status-transfer> </template> <script>Polymer({is:"coinify-trade-status",behaviors:[Polymer.AppLocalizeBehavior,CoinifyUtilsBehavior,CoinifyApiBehaviour],properties:{language:{value:"en"},generalError:{type:String,notify:!0},trade:{type:Object},showCardChargeWarning:{type:Boolean,notify:!0,computed:"_computeShowCardChargeWarning(trade.transferIn.medium, trade.state)"},showCardRejectExplanation:{type:Boolean,notify:!0,computed:"_computeShowCardRejectExplanation(trade.transferIn.medium, trade.state)"}},ready:function(){this.loadResources("assets/config/locales.json")},_formatAsFiat:function(e){return parseFloat(e).toFixed(2)},_getRate:function(e,t,r,a){var o=" ("+r+" / "+a+")",n=e/t;return"BTC"===r&&(o=" ("+a+" / "+r+")",n=t/e),n.toFixed(2)+o},_isTradeCompleted:function(e){return"completed"===e||"completed_test"===e},_formatAsDate:function(e){var t=new Date(e),r={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"};return t.toLocaleDateString("en-GB",r)},_computeShowCardChargeWarning:function(e,t){return"card"===e&&"reviewing"===t},_computeShowCardRejectExplanation:function(e,t){return"card"===e&&"rejected"===t}})</script> </dom-module>
<link rel="import" href="coinify-shared.html"> <link rel="import" href="coinify-alert-message.html"> <link rel="import" href="coinify-countdown-to.html"> <dom-module id="coinify-trade-page"> <template> <style include="coinify-shared"></style> <style>.coinify-logo img{width:70px;margin:5px}.coinify-logo{font-size:14px;margin:0 auto}section{min-width:360px}</style> <template is="dom-if" if="{{panelWrap}}"> <section class="panel panel-default"> <header id="panel-header" class="panel-heading"> <div class="row"> <div class="col-sm-6 font-bold">{{title}}</div> <div class="col-sm-6"> <div class="pull-right"> <template is="dom-if" if="{{showPriceQuoteCountDown}}" restamp="true"> {{tradeQuoteBuyAmount}} {{tradeQuoteBuyCurrency}} ({{tradeQuotePayAmount}} {{tradeQuotePayCurrency}}) <coinify-countdown-to prefix="Price lock: " countdown-to="{{tradeQuoteExpireTime}}" finished-text="Expired!" on-completed="_firePriceQuoteExpired"> </coinify-countdown-to> </template> </div> </div> </div> </header> <div class="panel-body"> <coinify-alert-message alert-message="[[generalError]]"></coinify-alert-message> <content></content> </div> <div class="panel-footer text-right"> <span class="coinify-logo"><span>Powered by</span><a href="https://www.coinify.com/" target="_blank"><img src="https://cdn.coinify.com/web-component/images/coinify-logo-powered-by.svg"></a></span> </div> </section> </template> <template is="dom-if" if="{{!panelWrap}}"> <coinify-alert-message alert-message="[[generalError]]"></coinify-alert-message> <content></content> </template> </template> <script>Polymer({is:"coinify-trade-page",properties:{title:String,generalError:{type:String},panelWrap:{type:Object,value:!0},tradeQuote:{type:Object,observer:"_updateShowPriceQuoteCountDown"},paymentMethod:{type:String,observer:"_updateShowPriceQuoteCountDown"},trade:{type:Object,observer:"_updateShowPriceQuoteCountDown"},showPriceQuoteCountDown:Boolean,tradeQuoteBuyAmount:{type:String,computed:"_computeQuoteBuyAmount(tradeQuote)"},tradeQuoteBuyCurrency:{type:String,computed:"_computeQuoteBuyCurrency(tradeQuote)"},tradeQuotePayAmount:{type:String,computed:"_computeQuotePayAmount(tradeQuote)"},tradeQuotePayCurrency:{type:String,computed:"_computeQuotePayCurrency(tradeQuote)"},tradeQuoteExpireTime:{type:Date,computed:"_computeTradeQuoteExpireTime(tradeQuote.expiryTime)"}},_updateShowPriceQuoteCountDown:function(){this.paymentMethod&&"bank"===this.paymentMethod?this.showPriceQuoteCountDown=!1:this.trade&&"awaiting_transfer_in"!==this.trade.state?this.showPriceQuoteCountDown=!1:this.showPriceQuoteCountDown=this.tradeQuote&&this.tradeQuote.expiryTime},_computeTradeQuoteExpireTime:function(e){return new Date(e)},_computeQuoteBuyAmount:function(e){if(e)return e.baseAmount>=0?Math.abs(e.baseAmount):Math.abs(e.quoteAmount)},_computeQuoteBuyCurrency:function(e){if(e)return e.baseAmount>=0?e.baseCurrency:e.quoteCurrency},_computeQuotePayAmount:function(e){if(e)return e.baseAmount>=0?Math.abs(e.quoteAmount):Math.abs(e.baseAmount)},_computeQuotePayCurrency:function(e){if(e)return e.baseAmount>=0?e.quoteCurrency:e.baseCurrency},_firePriceQuoteExpired:function(){this.fire("price-quote-expired",null,{bubbles:!0})}})</script> </dom-module>
<link rel="import" href="coinify-shared.html"> <link rel="import" href="libraries/iframe-resizer.html"> <dom-module id="coinify-buy-isignthis"> <template> <style include="coinify-shared">#isx-container{width:80vw;max-width:760px;min-width:200px;max-height:80vh;min-height:335px}iframe{width:100%}</style> <div id="isx-container"></div> </template> <script>Polymer({is:"coinify-buy-isignthis",properties:{externalId:{type:String,observer:"_initIFrame"},scriptInserted:{type:Boolean,observer:"_initIFrame",value:!1},istBaseUrl:{type:String,value:"https://verify.isignthis.com"}},attached:function(){var e=this,i=document.createElement("script");i.src=this.istBaseUrl+"/js/isx-embed.js",i.async=!0,i.onload=function(){e.scriptInserted=!0},Polymer.dom(this.root).appendChild(i)},_componentSizeChanged:function(){this.fire("coinify-refit-overlay")},_initIFrame:function(){var e=this;if(this.scriptInserted&&this.externalId){var i=document.createElement("iframe");i.src=this.istBaseUrl+"/landing/"+this.externalId+"?embed=true",i.id="iframe",i.width="100%",i.scrolling="no",i.style="border:none; height: 335px;",i.allow="geolocation",i.onload=this._componentSizeChanged.bind(this);for(var t=this.$$("#isx-container");t.firstChild;)t.removeChild(t.firstChild);t.appendChild(i),window.addEventListener("message",function(i){if(i&&i.data&&i.data.indexOf&&i.data.indexOf("[ISX-Embed]")!=-1){var t=i.data.replace("[ISX-Embed]",""),n=void 0;try{n=JSON.parse(t)}catch(r){console&&console.log&&(console.log("err caught:",r),console.log("err data:",i.data))}n&&"complete"===(""+n.event).toLowerCase()&&(n.state&&"declined"===(""+n.state).toLowerCase()&&e.fire("declined",null,{bubbles:!1}),e.fire("completed",null,{bubbles:!1}))}}),iFrameResize({log:!1,checkOrigin:!1,resizedCallback:this._componentSizeChanged.bind(this)},i)}}})</script> </dom-module>
<link rel="import" href="coinify-shared.html"> <link rel="import" href="libraries/iframe-resizer.html"> <link rel="import" href="coinify-api-behaviour.html"> <dom-module id="coinify-buy-authenticate-payment"> <template> <style include="coinify-shared">#payment-container{width:750px;overflow:hidden;min-height:520px;height:520px}#payment-container>iframe{width:100%!important;height:100%!important}</style> <coinify-alert-message id="errorBox" alert-message="[[errorMessage]]"></coinify-alert-message> <div id="payment-container"> </div> </template> <script>var defineProperty=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},get=function e(t,i,r){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,i);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,i,r)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(r)},set=function t(e,i,r,n){var a=Object.getOwnPropertyDescriptor(e,i);if(void 0===a){var o=Object.getPrototypeOf(e);null!==o&&t(o,i,r,n)}else if("value"in a&&a.writable)a.value=r;else{var p=a.set;void 0!==p&&p.call(n,r)}return r},_properties;Polymer({is:"coinify-buy-authenticate-payment",behaviors:[CoinifyApiBehaviour],properties:(_properties={providerPaymentUrl:{type:String,observer:"_initIFrame"},trade:{type:Object,observer:"_initIFrame"}},defineProperty(_properties,"providerPaymentUrl",{type:String}),defineProperty(_properties,"authenticatePaymentWithDetails",{type:Object,observer:"_initIFrame"}),defineProperty(_properties,"externalId",{type:String,observer:"_initIFrame"}),defineProperty(_properties,"scriptInserted",{type:Boolean,observer:"_initIFrame",value:!1}),defineProperty(_properties,"istBaseUrl",{type:String,value:"https://verify.isignthis.com"}),defineProperty(_properties,"provider",{type:String,observer:"_propertyProviderUpdated"}),defineProperty(_properties,"iFrameInitializing",{type:Boolean,value:!1}),defineProperty(_properties,"iFrameInitialized",{type:Boolean,value:!1}),_properties),attached:function(){},_initIFrame:function(){var e=this;if(this.authenticatePaymentWithDetails&&this.trade&&!this.iFrameInitialized&&!this.iFrameInitializing){var t=this.authenticatePaymentWithDetails;if(!t.CVV)return void console.error("Missing argument CVV in details",t);this.iFrameInitializing=!0;var i=this;this.authenticatePaymentWithDetails.tradeId=this.trade.id,window.CoinifyPspLib.handleTradePaymentInfo(this.authenticatePaymentWithDetails,this.$$("#payment-container")).then(function(t){i._handleTradePaymentResponse(t),e.iFrameInitialized=!0,i.iFrameInitializing=!1})["catch"](function(t){console.error("Error handling trade payment info."),e.errorMessage="Failed to authenticate - redirecting back to main screen.",window.setTimeout(function(){e.fire("cancel",null,{bubbles:!1})},8e3)})}},_propertyProviderUpdated:function(){},_handleTradePaymentResponse:function(e){this.fire("completed",null,{bubbles:!1})}})</script> </dom-module>
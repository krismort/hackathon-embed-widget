<link rel="import" href="coinify-shared.html"> <link rel="import" href="coinify-api-behaviour.html"> <dom-module id="coinify-trade-status-transfer"> <template> <style include="coinify-shared">span{white-space:nowrap}</style> <coinify-alert-message alert-message="[[generalError]]"></coinify-alert-message> <template is="dom-if" if="[[mediumIs.blockchain]]"> <div class="container-fluid"> <div class="row panel"> <div class="col-sm-6">Medium:</div> <div class="col-sm-6"><span class="pull-right">Bitcoin</span></div> </div> <div class="row panel"> <div class="col-sm-6">{{localize(&apos;order_status_transferout_address_label&apos;)}}</div> <div class="col-sm-6"><span class="pull-right">{{localize(&apos;order_status_transferout_address&apos;, &apos;address&apos;, transfer.details.account)}}</span></div> </div> <template is="dom-if" if="[[transfer.details.tx]]"> <div class="row panel"> <div class="col-sm-6">Transaction</div> <div class="col-sm-6"><span class="pull-right"><a target="_blank" href="https://blockchain.info/tx/{{transfer.details.tx}}">{{transfer.details.tx}}</a></span></div> </div> </template> </div> </template> <template is="dom-if" if="[[mediumIs.bank]]"> <div class="container-fluid"> <div class="row panel"> <div class="col-sm-6">Medium</div> <div class="col-sm-6"><span class="pull-right">Bank</span></div> </div> <template is="dom-if" if="[[bankAccount.bank.name]]"> <div class="row panel"> <div class="col-sm-6">Bank name:</div> <div class="col-sm-6"><span class="pull-right">[[bankAccount.bank.name]]</span></div> </div> </template> <template is="dom-if" if="[[bankAccount.bank.name]]"> <div class="row panel"> <div class="col-sm-6">Account currency:</div> <div class="col-sm-6"><span class="pull-right">{{bankAccount.account.currency}}</span></div> </div> </template> <template is="dom-if" if="[[bankAccount.holder.name]]"> <div class="row panel"> <div class="col-sm-6">Account holder:</div> <div class="col-sm-6"><span class="pull-right">{{bankAccount.holder.name}}</span></div> </div> </template> <template is="dom-if" if="[[bankAccount.account.number]]"> <div class="row panel"> <div class="col-sm-6">Account number:</div> <div class="col-sm-6"><span class="pull-right">{{_generateBankAccountNumberWithAsterisks(bankAccount)}}</span></div> </div> </template> </div> </template> <iron-ajax id="bankAccountEndpoint" headers="{{ajaxHeaders}}" url="{{coinifyApiBaseUrl}}/bank-accounts/{{transfer.mediumReceiveAccountId}}" last-response="{{bankAccount}}" on-response="_onBankAccountResponse" on-error="_handleApiError" handleas="json"> </iron-ajax> </template> <script>Polymer({is:"coinify-trade-status-transfer",behaviors:[Polymer.AppLocalizeBehavior,CoinifyApiBehaviour],properties:{language:{value:"en"},generalError:{type:String,notify:!0},transfer:{type:Object,observer:"_transferChanged"},mediumIs:{type:Object,computed:"_computeMediumIs(transfer)"},bankAccountTypeIs:{type:Object,computed:"_computeBankAccountTypeIs(bankAccount)"},bankAccount:Object},ready:function(){this.loadResources("assets/config/locales.json")},_accessTokenChanged:function(e){e&&this._computeMediumIs(this.transfer).bank&&this.$.bankAccountEndpoint.generateRequest()},_transferChanged:function(e){e&&this._computeMediumIs(e).bank&&this.$.bankAccountEndpoint.generateRequest()},_computeMediumIs:function(e){var n={blockchain:!!e&&"blockchain"===e.medium,card:!!e&&"card"===e.medium,bank:!!e&&"bank"===e.medium};return n},_computeBankAccountTypeIs:function(e){return this.mediumIs.bank&&e&&e.account&&e.account.type?{danish:"danish"===e.account.type,sepa:"sepa"===e.account.type,international:"international"===e.account.type}:{danish:!1,sepa:!1,international:!1}},_generateBankAccountNumberWithAsterisks:function(e){var n=e.account.number;return"*".repeat(n.length-3)+n.slice(-3)},_onBankAccountResponse:function(e,n){},_computeBankAccountParams:function(e){return{bankAccountId:e.mediumReceiveAccountId}},_formatAsFiat:function(e){return""+parseFloat(e).toFixed(2)},_formatAsDate:function(e){var n=new Date(e),t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"};return n.toLocaleDateString("en-GB",t)}})</script> </dom-module>